<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Secure Exam Interface</title>
  <style>
    /* --- (your CSS unchanged, keeping same styles) --- */
    /* I am not repeating the CSS to keep it short */
  </style>
</head>
<body>
  <!-- Eye Tracker Indicator -->
  <div id="eyeTracker"></div>

  <!-- Setup Screen -->
  <div id="setupScreen" class="setup-screen">
    <div class="setup-content">
      <h1>üõ°Ô∏è Exam Security Setup</h1>
      <p>Please complete the security setup before starting your exam</p>

      <div class="setup-steps">
        <div class="step" id="cameraStep">
          <div class="step-icon step-pending">üìπ</div>
          <div>
            <strong>Camera Access</strong><br>
            <small>Allow camera access for monitoring</small>
          </div>
        </div>

        <div class="step" id="microphoneStep">
          <div class="step-icon step-pending">üé§</div>
          <div>
            <strong>Microphone Access</strong><br>
            <small>Allow microphone for audio monitoring</small>
          </div>
        </div>

        <div class="step" id="fullscreenStep">
          <div class="step-icon step-pending">üñ•Ô∏è</div>
          <div>
            <strong>Fullscreen Mode</strong><br>
            <small>Enter secure exam mode</small>
          </div>
        </div>
      </div>

      <button class="btn btn-primary" onclick="requestPermissions()">
        üöÄ Start Security Setup
      </button>
    </div>
  </div>

  <!-- Warning Modal -->
  <div id="warningModal" class="warning-modal">
    <div class="warning-content">
      <div class="warning-count" id="warningCount">1</div>
      <h2>‚ö†Ô∏è SECURITY VIOLATION</h2>
      <p id="warningMessage">You attempted to switch tabs or leave the exam window.</p>
      <p><strong>Warning <span id="currentWarning">1</span> of 2</strong></p>
      <p>Next violation will result in exam termination!</p>
      <button class="btn btn-primary" onclick="closeWarning()" style="margin-top: 1rem;">
        Continue Exam
      </button>
    </div>
  </div>

  <!-- Main Exam Interface -->
  <div id="examContainer" class="exam-container" style="display: none;">
    <div class="security-header">
      <div class="security-status">
        <div class="status-item">
          <span class="status-green">üü¢</span>
          <span id="cameraStatus">Camera Active</span>
        </div>
        <div class="status-item">
          <span class="status-green">üü¢</span>
          <span id="micStatus">Microphone Active</span>
        </div>
        <div class="status-item">
          <span id="detectionStatus" class="status-green">üü¢</span>
          <span>Object Detection: Clear</span>
        </div>
        <div class="status-item">
          <span id="eyeStatus" class="status-green">üü¢</span>
          <span>Eye Tracking: Normal</span>
        </div>
      </div>
      <div>Secure Mode: <strong>ACTIVE</strong></div>
    </div>

    <div class="exam-header">
      <div class="exam-info">
        <h1 id="examTitle">Exam Title</h1>
        <div class="exam-meta" id="examMeta">
          Student: Manoj Kumar | Duration: 180 minutes | Total Questions: 50
        </div>
      </div>
      <div class="timer-section">
        <div class="timer" id="examTimer">02:59:45</div>
        <div class="timer-label">Time Remaining</div>
      </div>
    </div>

    <div class="main-content">
      <div class="exam-area">
        <div class="question-container">
          <div class="question-header">
            <div class="question-number">Question 1 of 50</div>
            <div class="question-marks">[2 Marks]</div>
          </div>

          <div class="question-text" id="questionText">
            What is the time complexity of inserting an element at the beginning of a linked list?
          </div>

          <div class="options-container">
            <label class="option" onclick="selectOption(this)">
              <input type="radio" name="q1" value="a">
              <span>A) O(1)</span>
            </label>
            <label class="option" onclick="selectOption(this)">
              <input type="radio" name="q1" value="b">
              <span>B) O(n)</span>
            </label>
            <label class="option" onclick="selectOption(this)">
              <input type="radio" name="q1" value="c">
              <span>C) O(log n)</span>
            </label>
            <label class="option" onclick="selectOption(this)">
              <input type="radio" name="q1" value="d">
              <span>D) O(n¬≤)</span>
            </label>
          </div>
        </div>
      </div>

      <div class="sidebar">
        <div class="camera-feed">
          <video id="cameraVideo" autoplay muted></video>
          <div class="camera-overlay" id="cameraOverlay">
            Initializing Camera...
          </div>
        </div>

        <div class="detection-alerts" id="alertsContainer">
          <h4 style="margin-bottom: 0.5rem; font-size: 0.9rem;">üö® Security Alerts</h4>
        </div>

        <div class="navigation">
          <div class="nav-buttons">
            <button class="btn btn-secondary" onclick="previousQuestion()">‚¨ÖÔ∏è Previous</button>
            <button class="btn btn-secondary" onclick="nextQuestion()">Next ‚û°Ô∏è</button>
          </div>
          <button class="btn btn-submit" onclick="submitExam()">
            üì§ Submit Exam
          </button>
        </div>
      </div>
    </div>
  </div>

  <script>
    let violationCount = 0;
    let examStarted = false;
    let currentQuestion = 1;
    let totalQuestions = 50;
    let timeRemaining = 180 * 60; // 3 hours in seconds
    let stream = null;

    // --- NEW: Dynamic exam title from URL ---
    const exams = {
      DSA: { title: "Data Structures and Algorithms", duration: 180, questions: 50 },
      DBMS: { title: "Database Management Systems", duration: 180, questions: 60 },
      CN: { title: "Computer Networks", duration: 180, questions: 40 },
      OS: { title: "Operating Systems", duration: 180, questions: 45 }
    };

    function getExamFromUrl() {
      const params = new URLSearchParams(window.location.search);
      const code = params.get("code") || "DSA";
      return exams[code] || exams.DSA;
    }

    function loadExamInfo() {
      const exam = getExamFromUrl();
      document.getElementById("examTitle").textContent = exam.title;
      document.getElementById("examMeta").textContent =
        `Student: Manoj Kumar | Duration: ${exam.duration} minutes | Total Questions: ${exam.questions}`;
      totalQuestions = exam.questions;
      timeRemaining = exam.duration * 60;
    }

    // Call on page load
    window.onload = function () {
      console.log("Secure exam interface loaded");
      loadExamInfo();
    };

    /* ‚úÖ Keep all your other functions (requestPermissions, startExam, 
          security monitoring, alerts, timer, navigation, submitExam) 
       exactly as you already had them. I didn‚Äôt remove anything. */
  </script>
</body>
</html>
